
<div class="project-details">
  <div class="details">
    <div class="back" (click)="navigateBack()">
      <mat-icon>arrow_back</mat-icon>
        Project List
    </div>
    <h1>{{data.name}}</h1>
    <p>{{data.description}}</p>
    
    <mat-chip-set
          class="chips"
          cdkDropList 
          cdkDropListOrientation="horizontal">
      <mat-chip
        class="example-box"
        cdkDrag
        *ngFor="let technology of data.technologies">
        {{technology}}
      </mat-chip>
    </mat-chip-set>
    <div class="link" *ngFor="let externalLink of data.externalLinks">
      <div>
          <a target="_blank" 
              [href]="externalLink.url" 
              [class.hidden]="!externalLink.url" 
              mat-icon-button>
              <mat-icon>link</mat-icon>
          </a>
      </div>
      <a target="_blank" [href]="externalLink.url">{{ externalLink.name }}</a>
    </div>  
  </div>
  <div class="table">
    <table class="mat-elevation-z5" mat-table [dataSource]="members" matSort>
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Name </th>
        <td mat-cell *matCellDef="let member"> 
          <div class="cellWithIcon">
            {{member.name}} 
            <mat-icon *ngIf="isProjectAdmin(member)">manage_accounts</mat-icon>
            <mat-icon *ngIf="isSupervisor(member)">supervisor_account</mat-icon>
          </div>
        </td>
      </ng-container>
      <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef> Email </th>
          <td mat-cell *matCellDef="let member"> {{member.email}} </td>
      </ng-container>
      <ng-container matColumnDef="role">
        <th mat-header-cell *matHeaderCellDef> Role </th>
        <td mat-cell *matCellDef="let member"> {{getRole(member.role)}} </td>
      </ng-container>
      <ng-container matColumnDef="status">
        <th class="acceptance-status-header" mat-header-cell *matHeaderCellDef> Status </th>
        <td mat-cell *matCellDef="let member">
          <div [class.accepted]="member.accepted" class="ellipse"></div>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columns"></tr>
      <tr mat-row *matRowDef="let row; columns: columns;"></tr>
    </table>
    <div class="buttons">
      <button *ngIf="showGradesButton" (click)="gradesShown = !gradesShown" mat-raised-button color="primary" cdkFocusInitial>{{
        gradesShown ? 'Hide grades' : 'Show grades'
      }}</button>
      <button *ngIf="showEditButton" (click)="editProject()" mat-raised-button color="primary" cdkFocusInitial>Edit project</button>
      <button *ngIf="showRemoveButton" (click)="openRemoveProjectDialog()" mat-raised-button color="primary" cdkFocusInitial>Remove project</button>
      <button *ngIf="showAcceptButton" (click)="acceptProject()" mat-raised-button color="primary" cdkFocusInitial>Accept project</button>
      <button *ngIf="showUnacceptButton" (click)="unacceptProject()" mat-raised-button color="primary" cdkFocusInitial>Unaccept project</button>  
    </div>
  </div>
</div>
<mat-tab-group *ngIf="gradesShown" class="mat-elevation-z8">
  <mat-tab 
    *ngIf="!allPhasesAreNotVisible(evaluationCards['FIRST'])" [label]="'First semester'"
  >
    <mat-tab-group>
      <mat-tab 
        *ngIf="evaluationCards['FIRST']['SEMESTER_PHASE'].visible"
        [label]="getEvaluationCardsTranslations('SEMESTER_PHASE')"
        [class.hidden]="!evaluationCards['FIRST']['SEMESTER_PHASE'].visible || (!evaluationCards['FIRST']['DEFENSE_PHASE'].visible && !evaluationCards['FIRST']['RETAKE_PHASE'].visible)"
        [disabled]="!evaluationCards['FIRST']['SEMESTER_PHASE'].visible || (!evaluationCards['FIRST']['DEFENSE_PHASE'].visible && !evaluationCards['FIRST']['RETAKE_PHASE'].visible)"
      >
        <project-grade [projectId]="data.id!" [evaulationCard]="evaluationCards['FIRST']['SEMESTER_PHASE']"></project-grade>
      </mat-tab>
      <mat-tab 
        *ngIf="evaluationCards['FIRST']['DEFENSE_PHASE'].visible"
        [label]="getEvaluationCardsTranslations('DEFENSE_PHASE')"
        [class.hidden]="!evaluationCards['FIRST']['DEFENSE_PHASE'].visible"
        [disabled]="!evaluationCards['FIRST']['DEFENSE_PHASE'].visible"
      >
        <project-grade [projectId]="data.id!" [evaulationCard]="evaluationCards['FIRST']['SEMESTER_PHASE']"></project-grade>
      </mat-tab>
      <mat-tab 
        *ngIf="evaluationCards['FIRST']['RETAKE_PHASE'].visible"
        [label]="getEvaluationCardsTranslations('RETAKE_PHASE')"
        [class.hidden]="!evaluationCards['FIRST']['RETAKE_PHASE'].visible"
        [disabled]="!evaluationCards['FIRST']['RETAKE_PHASE'].visible"
      >
        <project-grade [projectId]="data.id!" [evaulationCard]="evaluationCards['FIRST']['RETAKE_PHASE']"></project-grade>
      </mat-tab>
    </mat-tab-group>
  </mat-tab>
  <mat-tab 
    *ngIf="!allPhasesAreNotVisible(evaluationCards['SECOND'])" [label]="'Second semester'"
  >
    <mat-tab-group>
      <mat-tab 
        *ngIf="evaluationCards['SECOND']['SEMESTER_PHASE'].visible"
        [label]="getEvaluationCardsTranslations('SEMESTER_PHASE')"
        [class.hidden]="!evaluationCards['SECOND']['SEMESTER_PHASE'].visible || (!evaluationCards['SECOND']['DEFENSE_PHASE'].visible && !evaluationCards['SECOND']['RETAKE_PHASE'].visible)"
        [disabled]="!evaluationCards['SECOND']['SEMESTER_PHASE'].visible || (!evaluationCards['SECOND']['DEFENSE_PHASE'].visible && !evaluationCards['SECOND']['RETAKE_PHASE'].visible)"
      >
        <project-grade [projectId]="data.id!" [evaulationCard]="evaluationCards['SECOND']['SEMESTER_PHASE']"></project-grade>
      </mat-tab>
      <mat-tab 
        *ngIf="evaluationCards['SECOND']['DEFENSE_PHASE'].visible"
        [label]="getEvaluationCardsTranslations('DEFENSE_PHASE')"
        [class.hidden]="!evaluationCards['SECOND']['DEFENSE_PHASE'].visible"
        [disabled]="!evaluationCards['SECOND']['DEFENSE_PHASE'].visible"
      >
        <project-grade [projectId]="data.id!"  [evaulationCard]="evaluationCards['SECOND']['SEMESTER_PHASE']"></project-grade>
      </mat-tab>
      <mat-tab 
        *ngIf="evaluationCards['SECOND']['RETAKE_PHASE'].visible"
        [label]="getEvaluationCardsTranslations('RETAKE_PHASE')"
        [class.hidden]="!evaluationCards['SECOND']['RETAKE_PHASE'].visible"
        [disabled]="!evaluationCards['SECOND']['RETAKE_PHASE'].visible"
      >
        <project-grade [projectId]="data.id!" [evaulationCard]="evaluationCards['SECOND']['RETAKE_PHASE']"></project-grade>
      </mat-tab>
    </mat-tab-group>
  </mat-tab>
</mat-tab-group>


